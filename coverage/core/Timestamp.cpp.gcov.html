<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - cov.info - core/Timestamp.cpp</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">core</a> - Timestamp.cpp<span style="font-size: 80%;"> (source / <a href="Timestamp.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">cov.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">182</td>
            <td class="headerCovTableEntry">192</td>
            <td class="headerCovTableEntryHi">94.8 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-08-08 16:08:48</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">27</td>
            <td class="headerCovTableEntry">29</td>
            <td class="headerCovTableEntryHi">93.1 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**</a>
<span class="lineNum">       2 </span>            : 
<span class="lineNum">       3 </span>            : Copyright (c) 2014-2015 National Instruments Corp.
<span class="lineNum">       4 </span>            : 
<span class="lineNum">       5 </span>            : This software is subject to the terms described in the LICENSE.TXT file
<span class="lineNum">       6 </span>            : 
<span class="lineNum">       7 </span>            : SDG
<span class="lineNum">       8 </span>            : */
<span class="lineNum">       9 </span>            : 
<span class="lineNum">      10 </span>            : /*! \file
<span class="lineNum">      11 </span>            :  */
<span class="lineNum">      12 </span>            : 
<span class="lineNum">      13 </span>            : #include &quot;TypeDefiner.h&quot;
<span class="lineNum">      14 </span>            : #include &quot;Timestamp.h&quot;
<span class="lineNum">      15 </span>            : #include &quot;TDCodecVia.h&quot;
<span class="lineNum">      16 </span>            : #include &quot;ExecutionContext.h&quot;
<span class="lineNum">      17 </span>            : 
<span class="lineNum">      18 </span>            : #include &lt;math.h&gt; /* fabs */
<span class="lineNum">      19 </span>            : #include &lt;float.h&gt; /* DBL_EPSILON */
<span class="lineNum">      20 </span>            : 
<span class="lineNum">      21 </span>            : #if defined(VIREO_DATE_TIME_STDLIB)
<span class="lineNum">      22 </span>            : #if kVireoOS_win32U
<span class="lineNum">      23 </span>            :     #include &lt;windows.h&gt;
<span class="lineNum">      24 </span>            :     #include &lt;time.h&gt;
<span class="lineNum">      25 </span>            : #else
<span class="lineNum">      26 </span>            :     #include &lt;sys/time.h&gt;
<span class="lineNum">      27 </span>            : #endif
<span class="lineNum">      28 </span>            : #elif defined(VIREO_DATE_TIME_VXWORKS)
<span class="lineNum">      29 </span>            :     #include &lt;sys/times.h&gt;
<span class="lineNum">      30 </span>            :     #include &lt;timers.h&gt;
<span class="lineNum">      31 </span>            :     #include &lt;tickLib.h&gt;
<span class="lineNum">      32 </span>            : #endif
<span class="lineNum">      33 </span>            : 
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : #if (kVireoOS_win32U || kVireoOS_win64U)
<span class="lineNum">      36 </span>            : #define NOMINMAX
<span class="lineNum">      37 </span>            : #include &lt;Windows.h&gt;
<span class="lineNum">      38 </span>            : #elif kVireoOS_macosxU
<span class="lineNum">      39 </span>            : #define _BSD_SOURCE
<span class="lineNum">      40 </span>            : #include &lt;pthread.h&gt;
<span class="lineNum">      41 </span>            : #include &lt;time.h&gt;
<span class="lineNum">      42 </span>            : #include &lt;mach/mach_time.h&gt;
<span class="lineNum">      43 </span>            : #elif (kVireoOS_linuxU)
<span class="lineNum">      44 </span>            : #define _BSD_SOURCE
<span class="lineNum">      45 </span>            : #include &lt;pthread.h&gt;
<span class="lineNum">      46 </span>            : #include &lt;time.h&gt;
<span class="lineNum">      47 </span>            : #elif kVireoOS_ZynqARM
<span class="lineNum">      48 </span>            : #include &lt;xscutimer.h&gt;
<span class="lineNum">      49 </span>            : #elif kVireoOS_emscripten
<span class="lineNum">      50 </span>            : #include &lt;emscripten.h&gt;
<span class="lineNum">      51 </span>            : #endif
<span class="lineNum">      52 </span>            : 
<span class="lineNum">      53 </span>            : namespace Vireo
<a name="54"><span class="lineNum">      54 </span>            : {</a>
<span class="lineNum">      55 </span>            : //------------------------------------------------------------
<span class="lineNum">      56 </span>            : VIREO_FUNCTION_SIGNATURE1(GetTickCount, Int64)
<span class="lineNum">      57 </span>            : {
<span class="lineNum">      58 </span><span class="lineNoCov">          0 :     _Param(0) = gPlatform.Timer.TickCount();</span>
<span class="lineNum">      59 </span><span class="lineNoCov">          0 :     return _NextInstruction();</span>
<a name="60"><span class="lineNum">      60 </span>            : }</a>
<span class="lineNum">      61 </span>            : //------------------------------------------------------------
<span class="lineNum">      62 </span>            : VIREO_FUNCTION_SIGNATURE1(GetMicrosecondTickCount, Int64)
<span class="lineNum">      63 </span>            : {
<span class="lineNum">      64 </span><span class="lineCov">         20 :     _Param(0) = gPlatform.Timer.TickCountToMicroseconds(gPlatform.Timer.TickCount());</span>
<span class="lineNum">      65 </span><span class="lineCov">         20 :     return _NextInstruction();</span>
<a name="66"><span class="lineNum">      66 </span>            : }</a>
<span class="lineNum">      67 </span>            : //------------------------------------------------------------
<span class="lineNum">      68 </span>            : VIREO_FUNCTION_SIGNATURE1(GetMillisecondTickCount, UInt32)
<span class="lineNum">      69 </span>            : {
<span class="lineNum">      70 </span><span class="lineCov">         50 :     _Param(0) = (UInt32) gPlatform.Timer.TickCountToMilliseconds(gPlatform.Timer.TickCount());</span>
<span class="lineNum">      71 </span><span class="lineCov">         50 :     return _NextInstruction();</span>
<span class="lineNum">      72 </span>            : }
<span class="lineNum">      73 </span>            : 
<span class="lineNum">      74 </span>            : #if defined(VIREO_TYPE_Timestamp)
<span class="lineNum">      75 </span>            : /* Localize the warnings for float comparison to one place
<span class="lineNum">      76 </span>            :  see http://www.codeguru.com/forum/showthread.php?t=323835 */
<span class="lineNum">      77 </span>            : enum FloatComparisonMethod {
<span class="lineNum">      78 </span>            :     FloatComparisonExact,
<span class="lineNum">      79 </span>            :     FloatComparisonWithinEpsilon
<span class="lineNum">      80 </span>            : };
<a name="81"><span class="lineNum">      81 </span>            : </a>
<span class="lineNum">      82 </span>            : // January 1, 1904 (the epoch of AbsTime128) in FILETIME
<span class="lineNum">      83 </span><span class="lineCov">       1060 : static const Timestamp k_1904FileTime = Timestamp(0x0153b281e0fb4000ull, 0);</span>
<span class="lineNum">      84 </span>            : #if 0
<span class="lineNum">      85 </span>            : Timestamp ATime128FromHILOTime(const uInt32 &amp;high, const uInt32 &amp;low)
<span class="lineNum">      86 </span>            : {
<span class="lineNum">      87 </span>            :     NITime temp(high, low, 0, 0);
<span class="lineNum">      88 </span>            :     temp -= k_1904FileTime;
<span class="lineNum">      89 </span>            :     return Timestamp(temp /1E7);
<span class="lineNum">      90 </span>            : }
<span class="lineNum">      91 </span>            : #endif
<span class="lineNum">      92 </span>            : 
<span class="lineNum">      93 </span>            : /**
<a name="94"><span class="lineNum">      94 </span>            :  Functions for getting Timestamps</a>
<span class="lineNum">      95 </span>            :   */
<span class="lineNum">      96 </span>            : void GetCurrentTimestamp(Timestamp *t)
<span class="lineNum">      97 </span>            : {
<span class="lineNum">      98 </span>            : #if WIN32
<span class="lineNum">      99 </span>            :     struct timeval tv;
<span class="lineNum">     100 </span>            :     Int32 retval;
<span class="lineNum">     101 </span>            :     FILETIME ft;
<span class="lineNum">     102 </span>            :     UInt64    stdTime = 0;
<span class="lineNum">     103 </span>            : 
<span class="lineNum">     104 </span>            :     GetSystemTimeAsFileTime(&amp;ft);
<span class="lineNum">     105 </span>            : 
<span class="lineNum">     106 </span>            :     stdTime |= ft.dwHighDateTime;
<span class="lineNum">     107 </span>            :     stdTime &lt;&lt;= 32;
<span class="lineNum">     108 </span>            :     stdTime |= ft.dwLowDateTime;
<span class="lineNum">     109 </span>            : 
<span class="lineNum">     110 </span>            :     stdTime -= 11644473600000000Ui64;    // DELTA_EPOCH_IN_MICROSECS
<span class="lineNum">     111 </span>            :     stdTime /= 10;                        // Convert to microseconds
<span class="lineNum">     112 </span>            :     *t = Timestamp((Double)(stdTime/1000000UL), (stdTime % 1000000UL) / 1E6);
<span class="lineNum">     113 </span>            : 
<span class="lineNum">     114 </span>            : #elif defined(VIREO_DATE_TIME_STDLIB)
<span class="lineNum">     115 </span>            :     struct timeval tv;
<span class="lineNum">     116 </span>            :     Int32 retval;
<span class="lineNum">     117 </span>            : 
<span class="lineNum">     118 </span><span class="lineCov">          5 :     retval = gettimeofday(&amp;tv, null);</span>
<span class="lineNum">     119 </span><span class="lineCov">          5 :     if (retval == -1) {</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :         *t = Timestamp(0, 0);</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     } else {</span>
<span class="lineNum">     122 </span>            :     //    uInt32 tempTime = (uInt32) tv.tv_sec;
<span class="lineNum">     123 </span>            :     //    TToStd(&amp;tempTime);
<span class="lineNum">     124 </span><span class="lineCov">          5 :         *t = Timestamp((Double)tv.tv_sec, tv.tv_usec / 1E6);</span>
<span class="lineNum">     125 </span>            :     }
<span class="lineNum">     126 </span>            : #elif defined(VIREO_DATE_TIME_VXWORKS)
<span class="lineNum">     127 </span>            :     struct timespec ts;
<span class="lineNum">     128 </span>            :     Int32 retval;
<span class="lineNum">     129 </span>            : 
<span class="lineNum">     130 </span>            :     retval = clock_gettime(CLOCK_REALTIME, &amp;ts);
<span class="lineNum">     131 </span>            :     if (retval == -1) {
<span class="lineNum">     132 </span>            :         *t = Timestamp(0.0);
<span class="lineNum">     133 </span>            :     } else {
<span class="lineNum">     134 </span>            :         uInt32 tempTime = static_cast&lt;uInt32&gt;(ts.tv_sec);
<span class="lineNum">     135 </span>            :         TToStd(&amp;tempTime);
<span class="lineNum">     136 </span>            :         *t = Timestamp(static_cast&lt;Double&gt;(tempTime), ts.tv_nsec / 1E9);
<span class="lineNum">     137 </span>            :     }
<span class="lineNum">     138 </span>            : #endif
<a name="139"><span class="lineNum">     139 </span><span class="lineCov">          5 : }</span></a>
<span class="lineNum">     140 </span>            : //------------------------------------------------------------
<span class="lineNum">     141 </span>            : Timestamp::Timestamp(double seconds)
<span class="lineNum">     142 </span>            : {
<span class="lineNum">     143 </span><span class="lineCov">         30 :     if (seconds &gt; 0) {</span>
<span class="lineNum">     144 </span><span class="lineCov">         20 :         Double wholeSeconds = floor(seconds);</span>
<span class="lineNum">     145 </span><span class="lineCov">         20 :         _integer = (Int64)wholeSeconds;</span>
<span class="lineNum">     146 </span>            :         // Conceptually is 2^65 * fractional part though the double will only have ~15 digits
<span class="lineNum">     147 </span><span class="lineCov">         20 :         _fraction = (UInt64) (18446744073709551616.0 * (seconds - wholeSeconds));</span>
<span class="lineNum">     148 </span><span class="lineCov">         20 :     } else {</span>
<span class="lineNum">     149 </span><span class="lineCov">         10 :         Double wholeSeconds = ceil(seconds);</span>
<span class="lineNum">     150 </span><span class="lineCov">         10 :         _integer = (Int64)wholeSeconds;</span>
<span class="lineNum">     151 </span><span class="lineCov">         10 :         _fraction = (UInt64) (18446744073709551616.0 * (seconds - wholeSeconds));</span>
<span class="lineNum">     152 </span>            :     }
<a name="153"><span class="lineNum">     153 </span><span class="lineCov">         30 : }</span></a>
<span class="lineNum">     154 </span>            : //------------------------------------------------------------
<span class="lineNum">     155 </span>            : Double Timestamp::ToDouble() const
<span class="lineNum">     156 </span>            : {
<span class="lineNum">     157 </span><span class="lineCov">         95 :     Double wholeSeconds = (Double)this-&gt;Integer();</span>
<span class="lineNum">     158 </span><span class="lineCov">         95 :     Double fractionalSeconds = (Double)this-&gt;_fraction * (1.0 / 18446744073709551616.0);</span>
<span class="lineNum">     159 </span><span class="lineCov">         95 :     return wholeSeconds + fractionalSeconds;</span>
<a name="160"><span class="lineNum">     160 </span>            : }</a>
<span class="lineNum">     161 </span>            : //------------------------------------------------------------
<span class="lineNum">     162 </span>            : Timestamp const Timestamp::operator+(const Int64&amp; value)
<span class="lineNum">     163 </span>            : {
<span class="lineNum">     164 </span><span class="lineCov">         80 :     Timestamp answer;</span>
<span class="lineNum">     165 </span><span class="lineCov">         80 :     answer._integer = _integer + value;</span>
<span class="lineNum">     166 </span><span class="lineCov">         80 :     answer._fraction = _fraction;</span>
<span class="lineNum">     167 </span><span class="lineCov">         80 :     return answer;</span>
<a name="168"><span class="lineNum">     168 </span>            : }</a>
<span class="lineNum">     169 </span>            : //------------------------------------------------------------
<span class="lineNum">     170 </span>            : Timestamp const Timestamp::operator+(const Timestamp&amp; value)
<span class="lineNum">     171 </span>            : {
<span class="lineNum">     172 </span><span class="lineCov">         10 :     Timestamp answer;</span>
<span class="lineNum">     173 </span><span class="lineCov">         10 :     answer._integer = _integer + value._integer;</span>
<span class="lineNum">     174 </span><span class="lineCov">         10 :     answer._fraction = _fraction + value._fraction;</span>
<span class="lineNum">     175 </span><span class="lineCov">         10 :     if (answer._fraction &lt; _fraction) {</span>
<span class="lineNum">     176 </span><span class="lineCov">         10 :         answer._integer++;</span>
<span class="lineNum">     177 </span><span class="lineCov">         10 :     }</span>
<span class="lineNum">     178 </span><span class="lineCov">         10 :     return answer;</span>
<a name="179"><span class="lineNum">     179 </span>            : }</a>
<span class="lineNum">     180 </span>            : //------------------------------------------------------------
<span class="lineNum">     181 </span>            : Timestamp const Timestamp::operator-(const Timestamp&amp; value)
<span class="lineNum">     182 </span>            : {
<span class="lineNum">     183 </span><span class="lineCov">          5 :     Timestamp answer;</span>
<span class="lineNum">     184 </span><span class="lineCov">          5 :     answer._integer = _integer - value._integer;</span>
<span class="lineNum">     185 </span><span class="lineCov">          5 :     answer._fraction = _fraction - value._fraction;</span>
<span class="lineNum">     186 </span><span class="lineCov">          5 :     if (answer._fraction &gt; _fraction) {</span>
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :         answer._integer--;</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     189 </span><span class="lineCov">          5 :     return answer;</span>
<a name="190"><span class="lineNum">     190 </span>            : }</a>
<span class="lineNum">     191 </span>            : //------------------------------------------------------------
<span class="lineNum">     192 </span>            : VIREO_FUNCTION_SIGNATURE3(SubTimestamp, Timestamp, Timestamp, Double)
<span class="lineNum">     193 </span>            : {
<span class="lineNum">     194 </span><span class="lineCov">          5 :     Timestamp diff = _Param(0) - _Param(1);</span>
<span class="lineNum">     195 </span><span class="lineCov">          5 :     _Param(2) = diff.ToDouble();</span>
<span class="lineNum">     196 </span><span class="lineCov">          5 :     return _NextInstruction();</span>
<a name="197"><span class="lineNum">     197 </span>            : }</a>
<span class="lineNum">     198 </span>            : //------------------------------------------------------------
<span class="lineNum">     199 </span>            : VIREO_FUNCTION_SIGNATURE3(AddTimestampDoubleR, Timestamp, Double, Timestamp)
<span class="lineNum">     200 </span>            : {
<span class="lineNum">     201 </span><span class="lineCov">          5 :     Timestamp delta(_Param(1));</span>
<span class="lineNum">     202 </span><span class="lineCov">          5 :     _Param(2) = _Param(0) + delta;</span>
<span class="lineNum">     203 </span><span class="lineCov">          5 :     return _NextInstruction();</span>
<a name="204"><span class="lineNum">     204 </span>            : }</a>
<span class="lineNum">     205 </span>            : //------------------------------------------------------------
<span class="lineNum">     206 </span>            : VIREO_FUNCTION_SIGNATURE3(AddTimestampDoubleL, Double, Timestamp, Timestamp)
<span class="lineNum">     207 </span>            : {
<span class="lineNum">     208 </span><span class="lineCov">          5 :     Timestamp delta(_Param(0));</span>
<span class="lineNum">     209 </span><span class="lineCov">          5 :     _Param(2) = delta + _Param(1);</span>
<span class="lineNum">     210 </span><span class="lineCov">          5 :     return _NextInstruction();</span>
<a name="211"><span class="lineNum">     211 </span>            : }</a>
<span class="lineNum">     212 </span>            : //------------------------------------------------------------
<span class="lineNum">     213 </span>            : VIREO_FUNCTION_SIGNATURE3(AddTimestampInt32R, Timestamp, Int32, Timestamp)
<span class="lineNum">     214 </span>            : {
<span class="lineNum">     215 </span><span class="lineCov">          5 :     _Param(2) = _Param(0) + _Param(1);</span>
<span class="lineNum">     216 </span><span class="lineCov">          5 :     return _NextInstruction();</span>
<a name="217"><span class="lineNum">     217 </span>            : }</a>
<span class="lineNum">     218 </span>            : //------------------------------------------------------------
<span class="lineNum">     219 </span>            : VIREO_FUNCTION_SIGNATURE3(AddTimestampInt32L, Int32, Timestamp, Timestamp)
<span class="lineNum">     220 </span>            : {
<span class="lineNum">     221 </span><span class="lineCov">          5 :     _Param(2) = _Param(1) + _Param(0);</span>
<span class="lineNum">     222 </span><span class="lineCov">          5 :     return _NextInstruction();</span>
<a name="223"><span class="lineNum">     223 </span>            : }</a>
<span class="lineNum">     224 </span>            : //------------------------------------------------------------
<span class="lineNum">     225 </span>            : VIREO_FUNCTION_SIGNATURE3(IsLTTimestamp, Timestamp, Timestamp, Boolean)
<span class="lineNum">     226 </span>            : {
<span class="lineNum">     227 </span><span class="lineCov">         15 :     _Param(2) = _Param(0) &lt; _Param(1);</span>
<span class="lineNum">     228 </span><span class="lineCov">         15 :     return _NextInstruction();</span>
<a name="229"><span class="lineNum">     229 </span>            : }</a>
<span class="lineNum">     230 </span>            : //------------------------------------------------------------
<span class="lineNum">     231 </span>            : VIREO_FUNCTION_SIGNATURE3(IsLETimestamp, Timestamp, Timestamp, Boolean)
<span class="lineNum">     232 </span>            : {
<span class="lineNum">     233 </span><span class="lineCov">         15 :     _Param(2) = _Param(0) &lt;= _Param(1);</span>
<span class="lineNum">     234 </span><span class="lineCov">         15 :     return _NextInstruction();</span>
<a name="235"><span class="lineNum">     235 </span>            : }</a>
<span class="lineNum">     236 </span>            : //------------------------------------------------------------
<span class="lineNum">     237 </span>            : VIREO_FUNCTION_SIGNATURE3(IsGTTimestamp, Timestamp, Timestamp, Boolean)
<span class="lineNum">     238 </span>            : {
<span class="lineNum">     239 </span><span class="lineCov">         15 :     _Param(2) = _Param(0) &gt; _Param(1);</span>
<span class="lineNum">     240 </span><span class="lineCov">         15 :     return _NextInstruction();</span>
<a name="241"><span class="lineNum">     241 </span>            : }</a>
<span class="lineNum">     242 </span>            : //------------------------------------------------------------
<span class="lineNum">     243 </span>            : VIREO_FUNCTION_SIGNATURE3(IsGETimestamp, Timestamp, Timestamp, Boolean)
<span class="lineNum">     244 </span>            : {
<span class="lineNum">     245 </span><span class="lineCov">         15 :     _Param(2) = _Param(0) &gt;= _Param(1);</span>
<span class="lineNum">     246 </span><span class="lineCov">         15 :     return _NextInstruction();</span>
<a name="247"><span class="lineNum">     247 </span>            : }</a>
<span class="lineNum">     248 </span>            : //------------------------------------------------------------
<span class="lineNum">     249 </span>            : VIREO_FUNCTION_SIGNATURE1(GetTimestamp, Timestamp)
<span class="lineNum">     250 </span>            : {
<span class="lineNum">     251 </span><span class="lineCov">          5 :     GetCurrentTimestamp(_ParamPointer(0));</span>
<span class="lineNum">     252 </span><span class="lineCov">          5 :     return _NextInstruction();</span>
<a name="253"><span class="lineNum">     253 </span>            : }</a>
<span class="lineNum">     254 </span>            : //------------------------------------------------------------
<span class="lineNum">     255 </span>            : VIREO_FUNCTION_SIGNATURE2(TimestampConvertDouble, Timestamp, Double)
<span class="lineNum">     256 </span>            : {
<span class="lineNum">     257 </span><span class="lineCov">         20 :     _Param(1) = _Param(0).ToDouble();</span>
<span class="lineNum">     258 </span><span class="lineCov">         20 :     return _NextInstruction();</span>
<a name="259"><span class="lineNum">     259 </span>            : }</a>
<span class="lineNum">     260 </span>            : //------------------------------------------------------------
<span class="lineNum">     261 </span>            : Int64 SecondsFromBaseYear(Int64 year, Int64 baseYear)
<span class="lineNum">     262 </span>            : {
<span class="lineNum">     263 </span>            :     Int64 secondsInyear = 31536000;
<span class="lineNum">     264 </span>            :     Int64 secondsInLeap = 31622400;
<span class="lineNum">     265 </span><span class="lineNoCov">          0 :     Int64 numberOfLeap = (year-1)/4 - (year-1)/100 + (year-1)/400 - (baseYear/4-baseYear/100+baseYear/400);</span>
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :     Int64 totalSeconds = numberOfLeap*secondsInLeap + (year - baseYear - numberOfLeap)*secondsInyear;</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :     return totalSeconds;</span>
<a name="268"><span class="lineNum">     268 </span>            : }</a>
<span class="lineNum">     269 </span>            : //------------------------------------------------------------
<span class="lineNum">     270 </span>            : Int32 getYear(Int64 wholeSeconds, UInt64 fractions, Int32* yearSeconds, Int32* weekDays)
<span class="lineNum">     271 </span>            : {
<span class="lineNum">     272 </span>            :     // Does not account for leap seconds.
<span class="lineNum">     273 </span>            :     Int64 secondsInyear = 31536000;
<span class="lineNum">     274 </span>            :     Int64 secondsInLeap = 31622400;
<span class="lineNum">     275 </span>            :     // Thursday, January 01, 1903
<span class="lineNum">     276 </span>            :     Int32 baseYear = 1903;
<span class="lineNum">     277 </span>            :     Int32 baseWeek = 3;
<span class="lineNum">     278 </span>            :     Int32 currentYear = baseYear;
<span class="lineNum">     279 </span><span class="lineCov">         70 :     Int32 yearMax = (Int32)(wholeSeconds/secondsInyear);</span>
<span class="lineNum">     280 </span><span class="lineCov">         70 :     Int32 yearMin = (Int32)(wholeSeconds/secondsInLeap);</span>
<span class="lineNum">     281 </span>            : 
<span class="lineNum">     282 </span><span class="lineCov">         70 :     if (wholeSeconds &gt;= 0) {</span>
<span class="lineNum">     283 </span><span class="lineCov">        150 :         for (Int32 i = yearMin; i &lt;= yearMax; i++) {</span>
<span class="lineNum">     284 </span><span class="lineCov">         75 :             Int32 year = baseYear + i;</span>
<span class="lineNum">     285 </span>            :             Int32 numberOfLeap = 0;
<span class="lineNum">     286 </span><span class="lineCov">         75 :             numberOfLeap = year/4 - year/100 + year/400 - (baseYear/4-baseYear/100+baseYear/400);</span>
<span class="lineNum">     287 </span><span class="lineCov">         75 :             Int64 totalSeconds = numberOfLeap*secondsInLeap + (i-numberOfLeap)*secondsInyear;</span>
<span class="lineNum">     288 </span><span class="lineCov">         75 :             Int32 nextyear = baseYear + i +1;</span>
<span class="lineNum">     289 </span><span class="lineCov">         75 :             numberOfLeap = nextyear/4 - nextyear/100 + nextyear/400 - (baseYear/4-baseYear/100+baseYear/400);</span>
<span class="lineNum">     290 </span><span class="lineCov">         75 :             Int64 totalSecondsNext = numberOfLeap*secondsInLeap + (i+1-numberOfLeap)*secondsInyear;</span>
<span class="lineNum">     291 </span><span class="lineCov">        150 :             if (totalSeconds &lt;= wholeSeconds &amp;&amp; wholeSeconds &lt; totalSecondsNext) {</span>
<span class="lineNum">     292 </span>            :                 currentYear = nextyear;
<span class="lineNum">     293 </span><span class="lineCov">         65 :                 *yearSeconds = (Int32)(wholeSeconds - totalSeconds);</span>
<span class="lineNum">     294 </span><span class="lineCov">         65 :                 break;</span>
<span class="lineNum">     295 </span>            :             }
<span class="lineNum">     296 </span>            :         }
<span class="lineNum">     297 </span><span class="lineCov">          5 :     } else if (wholeSeconds &lt; 0) {</span>
<span class="lineNum">     298 </span><span class="lineCov">         10 :         for (Int32 i = yearMax; i &lt;= yearMin; i++) {</span>
<span class="lineNum">     299 </span><span class="lineCov">          5 :             Int32 year = baseYear + i;</span>
<span class="lineNum">     300 </span>            :             Int32 numberOfLeap = 0;
<span class="lineNum">     301 </span><span class="lineCov">          5 :             numberOfLeap = year/4 - year/100 + year/400 - (baseYear/4-baseYear/100+baseYear/400);</span>
<span class="lineNum">     302 </span><span class="lineCov">          5 :             Int64 totalSeconds = numberOfLeap*secondsInLeap + (i-numberOfLeap)*secondsInyear;</span>
<span class="lineNum">     303 </span><span class="lineCov">          5 :             Int32 previousyear = baseYear + i - 1;</span>
<span class="lineNum">     304 </span><span class="lineCov">          5 :             numberOfLeap = (previousyear/4 - previousyear/100 + previousyear/400)</span>
<span class="lineNum">     305 </span>            :                     - (baseYear/4-baseYear/100+baseYear/400);
<span class="lineNum">     306 </span><span class="lineCov">          5 :             Int64 totalSecondsPrevious = numberOfLeap*secondsInLeap + (i-1-numberOfLeap)*secondsInyear;</span>
<span class="lineNum">     307 </span><span class="lineCov">         10 :             if (totalSecondsPrevious &lt;= wholeSeconds &amp;&amp; wholeSeconds &lt; totalSeconds) {</span>
<span class="lineNum">     308 </span>            :                 currentYear = year;
<span class="lineNum">     309 </span>            :                 // this will make sure the *yearSeconds is always positive
<span class="lineNum">     310 </span><span class="lineCov">          5 :                 *yearSeconds = (Int32)(wholeSeconds - totalSecondsPrevious);</span>
<span class="lineNum">     311 </span><span class="lineCov">          5 :                 break;</span>
<span class="lineNum">     312 </span>            :             }
<span class="lineNum">     313 </span>            :         }
<span class="lineNum">     314 </span>            :     } else {
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :         *yearSeconds = 0;</span>
<span class="lineNum">     316 </span>            :         currentYear = 1904;
<span class="lineNum">     317 </span>            :     }
<span class="lineNum">     318 </span><span class="lineCov">         70 :     Int64 numberOfLeap = (currentYear-1)/4 - (currentYear-1)/100 + (currentYear-1)/400</span>
<span class="lineNum">     319 </span>            :             - (baseYear/4-baseYear/100+baseYear/400);
<span class="lineNum">     320 </span><span class="lineCov">         70 :     Int64 totalSeconds = numberOfLeap*secondsInLeap + (currentYear - baseYear - numberOfLeap)*secondsInyear;</span>
<span class="lineNum">     321 </span><span class="lineCov">         70 :     Int32 weekdaysOfyear = (totalSeconds/(24*3600) + baseWeek)%7;</span>
<span class="lineNum">     322 </span><span class="lineCov">         70 :     weekdaysOfyear = (weekdaysOfyear &lt; 0) ? (weekdaysOfyear + 7) : weekdaysOfyear;</span>
<span class="lineNum">     323 </span><span class="lineCov">         70 :     *weekDays = weekdaysOfyear;</span>
<span class="lineNum">     324 </span><span class="lineCov">         70 :     return currentYear;</span>
<a name="325"><span class="lineNum">     325 </span>            : }</a>
<span class="lineNum">     326 </span>            : //------------------------------------------------------------
<span class="lineNum">     327 </span>            : void getDate(Timestamp timestamp, Int64* secondofYearPtr, Int32* yearPtr,
<span class="lineNum">     328 </span>            :              Int32* monthPtr = NULL, Int32* dayPtr = NULL, Int32* hourPtr = NULL,
<span class="lineNum">     329 </span>            :              Int32* minPtr = NULL, Int32* secondPtr = NULL, Double* fractionPtr = NULL,
<span class="lineNum">     330 </span>            :              Int32* weekPtr = NULL, Int32* weekOfFirstDay = NULL, ConstCStr* timeZoneString = NULL)
<span class="lineNum">     331 </span>            : {
<span class="lineNum">     332 </span><span class="lineCov">         70 :     Int32 secondsOfYear = 0;</span>
<span class="lineNum">     333 </span><span class="lineCov">         70 :     Int32 firstweekDay = 0;</span>
<span class="lineNum">     334 </span>            : 
<span class="lineNum">     335 </span><span class="lineCov">         70 :     Int32 year = getYear(timestamp.Integer(), timestamp.Fraction(), &amp;secondsOfYear, &amp;firstweekDay);</span>
<span class="lineNum">     336 </span><span class="lineCov">         70 :     if (yearPtr!= NULL) {</span>
<span class="lineNum">     337 </span><span class="lineCov">         70 :         *yearPtr = year;</span>
<span class="lineNum">     338 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     339 </span><span class="lineCov">         70 :     if (weekOfFirstDay != NULL) {</span>
<span class="lineNum">     340 </span>            :         // get the first week day for this year
<span class="lineNum">     341 </span><span class="lineCov">         70 :         *weekOfFirstDay = firstweekDay;</span>
<span class="lineNum">     342 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     343 </span><span class="lineCov">         70 :     if (secondofYearPtr != NULL) {</span>
<span class="lineNum">     344 </span><span class="lineCov">         70 :         *secondofYearPtr = secondsOfYear;</span>
<span class="lineNum">     345 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     346 </span>            :     Int32 currentMonth = -2;
<span class="lineNum">     347 </span>            :     Int32 secondsofMonth = -2;
<span class="lineNum">     348 </span><span class="lineCov">        130 :     if ((year%4 == 0) &amp;&amp; ((year%100 != 0) || (year%400 == 0))) {</span>
<span class="lineNum">     349 </span>            :         // leap year
<span class="lineNum">     350 </span><span class="lineCov">         60 :         Int32 dayofMonth[] = {31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};</span>
<span class="lineNum">     351 </span>            :         Int32 seconds = 0;
<span class="lineNum">     352 </span><span class="lineCov">        460 :         for (Int32 i = 0; i &lt; 12; i++) {</span>
<span class="lineNum">     353 </span>            :             secondsofMonth = seconds;
<span class="lineNum">     354 </span><span class="lineCov">        230 :             seconds+=24*3600*dayofMonth[i];</span>
<span class="lineNum">     355 </span><span class="lineCov">        230 :             if (seconds &gt; secondsOfYear) {</span>
<span class="lineNum">     356 </span>            :                 currentMonth = i;
<span class="lineNum">     357 </span><span class="lineCov">         60 :                 secondsofMonth = secondsOfYear - secondsofMonth;</span>
<span class="lineNum">     358 </span><span class="lineCov">         60 :                 break;</span>
<span class="lineNum">     359 </span>            :             }
<span class="lineNum">     360 </span>            :         }
<span class="lineNum">     361 </span><span class="lineCov">         60 :     } else {</span>
<span class="lineNum">     362 </span><span class="lineCov">         10 :         Int32 dayofMonth[] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};</span>
<span class="lineNum">     363 </span>            :         Int32 seconds = 0;
<span class="lineNum">     364 </span><span class="lineCov">         40 :         for (Int32 i = 0; i &lt; 12; i++) {</span>
<span class="lineNum">     365 </span>            :             secondsofMonth = seconds;
<span class="lineNum">     366 </span><span class="lineCov">         20 :             seconds+=24*3600*dayofMonth[i];</span>
<span class="lineNum">     367 </span><span class="lineCov">         20 :             if (seconds &gt; secondsOfYear) {</span>
<span class="lineNum">     368 </span>            :                 currentMonth = i;
<span class="lineNum">     369 </span><span class="lineCov">         10 :                 secondsofMonth = secondsOfYear - secondsofMonth;</span>
<span class="lineNum">     370 </span><span class="lineCov">         10 :                 break;</span>
<span class="lineNum">     371 </span>            :             }
<span class="lineNum">     372 </span>            :         }
<span class="lineNum">     373 </span><span class="lineCov">         10 :     }</span>
<span class="lineNum">     374 </span>            :     // Get timezone abbrevation
<span class="lineNum">     375 </span>            :     ConstCStr timeZoneAbbr;
<span class="lineNum">     376 </span>            : #if (kVireoOS_linuxU || kVireoOS_macosxU)
<span class="lineNum">     377 </span>            :     time_t rawtime;
<span class="lineNum">     378 </span>            :     struct tm* timeinfo;
<span class="lineNum">     379 </span><span class="lineCov">         70 :     time(&amp;rawtime);</span>
<span class="lineNum">     380 </span><span class="lineCov">         70 :     timeinfo = localtime(&amp;rawtime);</span>
<span class="lineNum">     381 </span><span class="lineCov">         70 :     timeZoneAbbr = timeinfo-&gt;tm_zone;</span>
<span class="lineNum">     382 </span>            : #elif kVireoOS_emscripten
<span class="lineNum">     383 </span>            :     timeZoneAbbr = emscripten_run_script_string(&quot;(function() {var now = new Date().toString(); var TZ = now.indexOf('(') &gt; -1 ?now.match(/\\([^\\)]+\\)/)[0].match(/[A-Z]/g).join(''):now.match(/[A-Z]{3,4}/)[0];if (TZ == 'GMT' &amp;&amp; /(GMT\\W*\\d{4})/.test(now)) TZ = RegExp.$1;return TZ;}());&quot;);
<span class="lineNum">     384 </span>            : #else
<span class="lineNum">     385 </span>            :     timeZoneAbbr = &quot;TODO-TMZ&quot;;
<span class="lineNum">     386 </span>            : #endif
<span class="lineNum">     387 </span><span class="lineCov">         70 :     Int32 days = secondsofMonth/(24*3600);</span>
<span class="lineNum">     388 </span><span class="lineCov">         70 :     Int32 secondsofHour = secondsofMonth%(24*3600);</span>
<span class="lineNum">     389 </span><span class="lineCov">         70 :     Int32 hours = secondsofHour/3600;</span>
<span class="lineNum">     390 </span><span class="lineCov">         70 :     Int32 secondsofMinutes = secondsofHour%(3600);</span>
<span class="lineNum">     391 </span><span class="lineCov">         70 :     Int32 minutes = secondsofMinutes/60;</span>
<span class="lineNum">     392 </span><span class="lineCov">         70 :     Int32 seconds = secondsofMinutes%60;</span>
<span class="lineNum">     393 </span><span class="lineCov">         70 :     if (monthPtr != NULL) {</span>
<span class="lineNum">     394 </span><span class="lineCov">         70 :         *monthPtr = currentMonth;</span>
<span class="lineNum">     395 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     396 </span><span class="lineCov">         70 :     if (dayPtr != NULL) {</span>
<span class="lineNum">     397 </span><span class="lineCov">         70 :         *dayPtr = days;</span>
<span class="lineNum">     398 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     399 </span><span class="lineCov">         70 :     if (hourPtr != NULL) {</span>
<span class="lineNum">     400 </span><span class="lineCov">         70 :         *hourPtr = hours;</span>
<span class="lineNum">     401 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     402 </span><span class="lineCov">         70 :     if (minPtr != NULL) {</span>
<span class="lineNum">     403 </span><span class="lineCov">         70 :         *minPtr = minutes;</span>
<span class="lineNum">     404 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     405 </span><span class="lineCov">         70 :     if (secondPtr != NULL) {</span>
<span class="lineNum">     406 </span><span class="lineCov">         70 :         *secondPtr = seconds;</span>
<span class="lineNum">     407 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     408 </span><span class="lineCov">         70 :     if (fractionPtr != NULL) {</span>
<span class="lineNum">     409 </span><span class="lineCov">         70 :         *fractionPtr = timestamp.ToDouble() - timestamp.Integer();</span>
<span class="lineNum">     410 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     411 </span><span class="lineCov">         70 :     if (weekPtr != NULL) {</span>
<span class="lineNum">     412 </span><span class="lineCov">         70 :         *weekPtr = (secondsOfYear/(24*3600)+firstweekDay)%7;</span>
<span class="lineNum">     413 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     414 </span><span class="lineCov">         70 :     if (timeZoneString != NULL) {</span>
<span class="lineNum">     415 </span><span class="lineCov">         70 :         *timeZoneString = timeZoneAbbr;</span>
<span class="lineNum">     416 </span><span class="lineCov">         70 :     }</span>
<span class="lineNum">     417 </span><span class="lineCov">         70 : }</span>
<span class="lineNum">     418 </span>            : Int32 Date::_SystemLocaletimeZone = 0;
<a name="419"><span class="lineNum">     419 </span>            : </a>
<span class="lineNum">     420 </span>            : //------------------------------------------------------------
<span class="lineNum">     421 </span>            : Date::Date(Timestamp timestamp, Int32 timeZone)
<span class="lineNum">     422 </span>            : {
<span class="lineNum">     423 </span><span class="lineCov">         70 :     _timeZoneOffset = timeZone;</span>
<span class="lineNum">     424 </span><span class="lineCov">         70 :     Timestamp local = timestamp + _timeZoneOffset;</span>
<span class="lineNum">     425 </span><span class="lineCov">        140 :     getDate(local, &amp;_secondsOfYear, &amp;_year, &amp;_month, &amp;_day, &amp;_hour,</span>
<span class="lineNum">     426 </span><span class="lineCov">         70 :             &amp;_minute, &amp;_second, &amp;_fractionalSecond, &amp;_weekday, &amp;_firstWeekDay, &amp;_timeZoneString);</span>
<span class="lineNum">     427 </span><span class="lineCov">         70 :     _DTS = isDTS();</span>
<a name="428"><span class="lineNum">     428 </span><span class="lineCov">         70 : }</span></a>
<span class="lineNum">     429 </span>            : //------------------------------------------------------------
<span class="lineNum">     430 </span>            : Int32 Date::getLocaletimeZone()
<span class="lineNum">     431 </span>            : {
<span class="lineNum">     432 </span>            : #if kVireoOS_emscripten
<span class="lineNum">     433 </span>            :     TempStackCString result;
<span class="lineNum">     434 </span>            :     result.AppendCStr(emscripten_run_script_string(&quot;new Date().getTimezoneOffset()&quot;));
<span class="lineNum">     435 </span>            :     EventLog log(EventLog::DevNull);
<span class="lineNum">     436 </span>            :     SubString valueString(result.Begin(), result.End());
<span class="lineNum">     437 </span>            :     TDViaParser parser(THREAD_TADM(), &amp;valueString, &amp;log, 1);
<span class="lineNum">     438 </span>            :     TypeRef parseType = THREAD_TADM()-&gt;FindType(tsInt32Type);
<span class="lineNum">     439 </span>            :     Int32 minutes;
<span class="lineNum">     440 </span>            :     parser.ParseData(parseType, &amp;minutes);
<span class="lineNum">     441 </span>            :     _SystemLocaletimeZone = (-1) * minutes * 60;
<span class="lineNum">     442 </span>            :     // flipping the sign of the time zone since JS runtime will be positive
<span class="lineNum">     443 </span>            :     // for being behind UTC and negative for being ahead. ctime assumes
<span class="lineNum">     444 </span>            :     // negative for behind and postive for ahead. We attempt to match the ctime result.
<span class="lineNum">     445 </span>            :     // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset
<span class="lineNum">     446 </span>            : #elif (kVireoOS_linuxU || kVireoOS_macosxU)
<span class="lineNum">     447 </span>            :     time_t rawtime;
<span class="lineNum">     448 </span>            :     struct tm* timeinfo;
<span class="lineNum">     449 </span><span class="lineCov">         30 :     time(&amp;rawtime);</span>
<span class="lineNum">     450 </span><span class="lineCov">         30 :     timeinfo = localtime(&amp;rawtime);</span>
<span class="lineNum">     451 </span><span class="lineCov">         30 :     _SystemLocaletimeZone = timeinfo-&gt;tm_gmtoff;</span>
<span class="lineNum">     452 </span>            : #else
<span class="lineNum">     453 </span>            :     // Not implemented for Win32 yet
<span class="lineNum">     454 </span>            :     _SystemLocaletimeZone = 0;
<span class="lineNum">     455 </span>            : #endif
<span class="lineNum">     456 </span><span class="lineCov">         30 :     return _SystemLocaletimeZone;</span>
<a name="457"><span class="lineNum">     457 </span>            : };</a>
<span class="lineNum">     458 </span>            : //------------------------------------------------------------
<span class="lineNum">     459 </span>            : Int32 Date::isDTS()
<span class="lineNum">     460 </span>            : {
<span class="lineNum">     461 </span><span class="lineCov">         70 :     return 0;</span>
<span class="lineNum">     462 </span>            : }
<span class="lineNum">     463 </span>            : #endif
<a name="464"><span class="lineNum">     464 </span>            : </a>
<span class="lineNum">     465 </span>            : 
<span class="lineNum">     466 </span><span class="lineCov">       1060 : DEFINE_VIREO_BEGIN(Timestamp)</span>
<span class="lineNum">     467 </span><span class="lineCov">       1060 :     DEFINE_VIREO_REQUIRE(IEEE754Math)</span>
<span class="lineNum">     468 </span>            : 
<span class="lineNum">     469 </span>            :     // Low level time functions
<span class="lineNum">     470 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION(GetTickCount, &quot;p(o(Int64))&quot;)</span>
<span class="lineNum">     471 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION(GetMicrosecondTickCount, &quot;p(o(Int64))&quot;)</span>
<span class="lineNum">     472 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION(GetMillisecondTickCount, &quot;p(o(UInt32))&quot;)</span>
<span class="lineNum">     473 </span>            : 
<span class="lineNum">     474 </span>            : #if defined(VIREO_TYPE_Timestamp)
<span class="lineNum">     475 </span><span class="lineCov">       1060 :     DEFINE_VIREO_TYPE(Timestamp, &quot;c(e(Int64 seconds) e(UInt64 fraction))&quot;)</span>
<span class="lineNum">     476 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION(GetTimestamp, &quot;p(o(Timestamp))&quot;)</span>
<span class="lineNum">     477 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(IsLT, IsLTTimestamp, &quot;p(i(Timestamp) i(Timestamp) o(Boolean))&quot;)</span>
<span class="lineNum">     478 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(IsLE, IsLETimestamp, &quot;p(i(Timestamp) i(Timestamp) o(Boolean))&quot;)</span>
<span class="lineNum">     479 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(IsGE, IsGETimestamp, &quot;p(i(Timestamp) i(Timestamp) o(Boolean))&quot;)</span>
<span class="lineNum">     480 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(IsGT, IsGTTimestamp, &quot;p(i(Timestamp) i(Timestamp) o(Boolean))&quot;)</span>
<span class="lineNum">     481 </span>            : 
<span class="lineNum">     482 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(Add, AddTimestampInt32R, &quot;p(i(Timestamp) i(Int32) o(Timestamp))&quot;)</span>
<span class="lineNum">     483 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(Add, AddTimestampInt32L, &quot;p(i(Int32) i(Timestamp) o(Timestamp))&quot;)</span>
<span class="lineNum">     484 </span>            : #if defined(VIREO_TYPE_Double)
<span class="lineNum">     485 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(Sub, SubTimestamp, &quot;p(i(Timestamp) i(Timestamp)o(Double))&quot;)</span>
<span class="lineNum">     486 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(Add, AddTimestampDoubleL, &quot;p(i(Double)i(Timestamp)o(Timestamp))&quot;)</span>
<span class="lineNum">     487 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(Add, AddTimestampDoubleR, &quot;p(i(Timestamp)i(Double)o(Timestamp))&quot;)</span>
<span class="lineNum">     488 </span><span class="lineCov">       1060 :     DEFINE_VIREO_FUNCTION_CUSTOM(Convert, TimestampConvertDouble, &quot;p(i(Timestamp) o(Double))&quot;)</span>
<span class="lineNum">     489 </span>            : 
<span class="lineNum">     490 </span>            : #endif
<span class="lineNum">     491 </span>            : #endif
<span class="lineNum">     492 </span>            : 
<span class="lineNum">     493 </span><span class="lineCov">       2120 : DEFINE_VIREO_END()</span>
<span class="lineNum">     494 </span>            : }  // namespace Vireo
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
