<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - cov.info - include/TDCodecVia.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">include</a> - TDCodecVia.h<span style="font-size: 80%;"> (source / <a href="TDCodecVia.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">cov.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2016-08-08 16:08:48</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /**</a>
<span class="lineNum">       2 </span>            :  
<span class="lineNum">       3 </span>            : Copyright (c) 2014-2015 National Instruments Corp.
<span class="lineNum">       4 </span>            :  
<span class="lineNum">       5 </span>            : This software is subject to the terms described in the LICENSE.TXT file
<span class="lineNum">       6 </span>            :  
<span class="lineNum">       7 </span>            : SDG
<span class="lineNum">       8 </span>            : */
<span class="lineNum">       9 </span>            : 
<span class="lineNum">      10 </span>            : /*! \file
<span class="lineNum">      11 </span>            :     \brief A Vireo codec for the VIA (VI Assembly) text format.
<span class="lineNum">      12 </span>            : */
<span class="lineNum">      13 </span>            : 
<span class="lineNum">      14 </span>            : #ifndef TDCodecVia_h
<span class="lineNum">      15 </span>            : #define TDCodecVia_h
<span class="lineNum">      16 </span>            : 
<span class="lineNum">      17 </span>            : #include &quot;TypeAndDataManager.h&quot;
<span class="lineNum">      18 </span>            : #include &quot;EventLog.h&quot;
<span class="lineNum">      19 </span>            : 
<span class="lineNum">      20 </span>            : namespace Vireo
<span class="lineNum">      21 </span>            : {
<span class="lineNum">      22 </span>            : 
<span class="lineNum">      23 </span>            : class VIClump;
<span class="lineNum">      24 </span>            : class VirtualInstrument;
<span class="lineNum">      25 </span>            : class InstructionAllocator;
<span class="lineNum">      26 </span>            : 
<span class="lineNum">      27 </span>            : //! Punctuation and options used by the TDViaFormatter
<span class="lineNum">      28 </span>            : enum ViaFormat {
<span class="lineNum">      29 </span>            :     kViaFormat_NoFieldNames = 0,
<span class="lineNum">      30 </span>            :     kViaFormat_UseFieldNames = 1,
<span class="lineNum">      31 </span>            :     kViaFormat_QuotedFieldNames =  kViaFormat_UseFieldNames + 2,
<span class="lineNum">      32 </span>            :     kViaFormat_PercentEncodeFieldNames = kViaFormat_UseFieldNames + 4,
<span class="lineNum">      33 </span>            : };
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : struct ViaFormatChars
<span class="lineNum">      36 </span>            : {
<span class="lineNum">      37 </span>            :     ConstCStr   _name;
<span class="lineNum">      38 </span>            :     Utf8Char    _arrayPre;
<span class="lineNum">      39 </span>            :     Utf8Char    _arrayPost;
<span class="lineNum">      40 </span>            :     Utf8Char    _clusterPre;
<span class="lineNum">      41 </span>            :     Utf8Char    _clusterPost;
<span class="lineNum">      42 </span>            :     Utf8Char    _itemSeperator;
<span class="lineNum">      43 </span>            :     Utf8Char    _quote;
<a name="44"><span class="lineNum">      44 </span>            :     ViaFormat   _fieldNameFormat;</a>
<a name="45"><span class="lineNum">      45 </span>            :     </a>
<span class="lineNum">      46 </span><span class="lineCov">       9625 :     Boolean UseFieldNames()      { return _fieldNameFormat &amp;  kViaFormat_UseFieldNames ? true : false; }</span>
<span class="lineNum">      47 </span><span class="lineCov">         90 :     Boolean QuoteFieldNames()    { return _fieldNameFormat == kViaFormat_QuotedFieldNames; }</span>
<span class="lineNum">      48 </span>            : };
<span class="lineNum">      49 </span>            : 
<span class="lineNum">      50 </span>            : struct ViaFormatOptions
<span class="lineNum">      51 </span>            : {
<span class="lineNum">      52 </span>            :     //Once formatter digs below top level this will be on. Constructor controls initial value
<span class="lineNum">      53 </span>            :     Boolean         _bQuoteStrings;
<span class="lineNum">      54 </span>            :     Boolean         _bEscapeStrings;
<span class="lineNum">      55 </span>            :     Int32           _fieldWidth;
<span class="lineNum">      56 </span>            :     ViaFormatChars  _fmt;
<span class="lineNum">      57 </span>            : };
<span class="lineNum">      58 </span>            : 
<span class="lineNum">      59 </span>            : //------------------------------------------------------------
<span class="lineNum">      60 </span>            : // Find or build a type in the the type manager corresponding to ascii type description
<span class="lineNum">      61 </span>            : // The are three primary errors that are likely to happen.
<span class="lineNum">      62 </span>            : // 1. Grammar errors.  For example parens or key words are misplaced
<span class="lineNum">      63 </span>            : // these tokens direct the recursive descent parser, so on is encountered parsing will cease.
<span class="lineNum">      64 </span>            : // 2. Semantic errors. For example, arguments to functions might have the wrong type
<span class="lineNum">      65 </span>            : // 3. Out of memory. Memory will be allocated out of the designated TypeManager
<span class="lineNum">      66 </span>            : // if the quota is exceeded parsing will cease.
<span class="lineNum">      67 </span>            : 
<span class="lineNum">      68 </span>            : //! The VIA decoder, also includes options for JSON and C style initializers.
<span class="lineNum">      69 </span>            : class TDViaParser
<span class="lineNum">      70 </span>            : {
<span class="lineNum">      71 </span>            : private:
<span class="lineNum">      72 </span>            :     TypeManagerRef  _typeManager;
<span class="lineNum">      73 </span>            :     SubString       _string;      // &quot;Begin()&quot; moves through string as it is parsed.
<span class="lineNum">      74 </span>            :     const Utf8Char* _originalStart;
<span class="lineNum">      75 </span>            :     Int32           _lineNumberBase;
<span class="lineNum">      76 </span>            :       
<span class="lineNum">      77 </span>            : public:
<a name="78"><span class="lineNum">      78 </span>            :     // Format options also used in ViaFormatter</a>
<span class="lineNum">      79 </span>            :     ViaFormatOptions  _options;
<span class="lineNum">      80 </span><span class="lineCov">     411930 :     ViaFormatChars&amp; Fmt()  { return _options._fmt; }</span>
<span class="lineNum">      81 </span>            : 
<span class="lineNum">      82 </span>            :     Boolean         _loadVIsImmediatly;
<span class="lineNum">      83 </span>            :     EventLog*       _pLog;
<a name="84"><span class="lineNum">      84 </span>            : </a>
<span class="lineNum">      85 </span>            :     void    LogEvent(EventLog::EventSeverity severity, ConstCStr message, ...);
<span class="lineNum">      86 </span><span class="lineCov">         40 :     Int32   ErrorCount() { return _pLog-&gt;TotalErrorCount(); }</span>
<span class="lineNum">      87 </span>            :     Int32   CalcCurrentLine();
<span class="lineNum">      88 </span>            :     void    RepinLineNumberBase();
<span class="lineNum">      89 </span>            : 
<span class="lineNum">      90 </span>            :     TDViaParser(TypeManagerRef typeManager, SubString* typeString, EventLog *pLog, Int32 lineNumberBase, SubString* format = null);
<span class="lineNum">      91 </span>            :     TypeRef ParseType(TypeRef patternType = null);
<span class="lineNum">      92 </span>            :     TypeRef ParseLiteral(TypeRef patternType);
<span class="lineNum">      93 </span>            :     void    ParseData(TypeRef type, void* pData);
<span class="lineNum">      94 </span>            :     Boolean EatJSONPath(SubString* path);
<span class="lineNum">      95 </span>            :     NIError ParseREPL();
<span class="lineNum">      96 </span>            :     TypeRef ParseEnqueue();
<span class="lineNum">      97 </span>            :     void    PreParseElements(Int32 rank, ArrayDimensionVector dimensionLengths);
<span class="lineNum">      98 </span>            :     TokenTraits ReadArrayItem(SubString* input, SubString* token);
<span class="lineNum">      99 </span>            :     void    ParseArrayData(TypedArrayCoreRef array, void* pData, Int32 level);
<span class="lineNum">     100 </span>            :     void    ParseVirtualInstrument(TypeRef viType, void* pData);
<span class="lineNum">     101 </span>            :     void    ParseClump(VIClump* clump, InstructionAllocator* cia);
<a name="102"><span class="lineNum">     102 </span>            :     void    PreParseClump(VIClump* viClump);</a>
<span class="lineNum">     103 </span>            :     void    ParseInstructionArguments(VIClump* clump);
<span class="lineNum">     104 </span><span class="lineCov">         65 :     SubString* TheString() {return &amp;_string;}</span>
<span class="lineNum">     105 </span>            :     
<span class="lineNum">     106 </span>            : public:
<span class="lineNum">     107 </span>            :     static NIError StaticRepl(TypeManagerRef typeManager, SubString *replStream);
<span class="lineNum">     108 </span>            :     static void FinalizeVILoad(VirtualInstrument* vi, EventLog* pLog);
<span class="lineNum">     109 </span>            :     static void FinalizeModuleLoad(TypeManagerRef tm, EventLog* pLog);
<a name="110"><span class="lineNum">     110 </span>            :     </a>
<span class="lineNum">     111 </span>            : private :
<span class="lineNum">     112 </span><span class="lineCov">       1130 :     TypeRef BadType()   {return _typeManager-&gt;BadType();}</span>
<span class="lineNum">     113 </span>            :     void    ParseAggregateElementList(TypeRef ElementTypes[], AggregateAlignmentCalculator* calculator);
<span class="lineNum">     114 </span>            :     TypeRef ParseArray();
<span class="lineNum">     115 </span>            :     TypeRef ParseBitBlock();
<span class="lineNum">     116 </span>            :     TypeRef ParseBitCluster();
<span class="lineNum">     117 </span>            :     TypeRef ParseCluster();
<span class="lineNum">     118 </span>            :     TypeRef ParseDefine();
<span class="lineNum">     119 </span>            :     TypeRef ParseRequire();
<span class="lineNum">     120 </span>            :     TypeRef ParseContext();
<span class="lineNum">     121 </span>            :     TypeRef ParseDefaultValue(Boolean mutableValue);
<span class="lineNum">     122 </span>            :     TypeRef ParseEquivalence();
<span class="lineNum">     123 </span>            :     TypeRef ParseNamedType();
<span class="lineNum">     124 </span>            :     TypeRef ParseParamBlock();
<span class="lineNum">     125 </span>            :     TypeRef ParsePointerType(Boolean shortNotation);
<span class="lineNum">     126 </span>            :     EncodingEnum ParseEncoding(SubString* string);
<span class="lineNum">     127 </span>            : };
<span class="lineNum">     128 </span>            : 
<span class="lineNum">     129 </span>            : #if defined (VIREO_VIA_FORMATTER)
<span class="lineNum">     130 </span>            : class TDViaFormatterTypeVisitor;
<span class="lineNum">     131 </span>            : 
<span class="lineNum">     132 </span>            : //! The VIA encoder.
<span class="lineNum">     133 </span>            : class TDViaFormatter
<span class="lineNum">     134 </span>            : {
<span class="lineNum">     135 </span>            :     friend class TDViaFormatterTypeVisitor;
<span class="lineNum">     136 </span>            : private:
<a name="137"><span class="lineNum">     137 </span>            :     StringRef       _string;</a>
<span class="lineNum">     138 </span>            :     ViaFormatOptions  _options;
<span class="lineNum">     139 </span><span class="lineCov">     127130 :     ViaFormatChars&amp; Fmt() { return _options._fmt; }</span>
<span class="lineNum">     140 </span>            :     
<span class="lineNum">     141 </span>            :     static const Int32 kTempFormattingBufferSize = 100;
<span class="lineNum">     142 </span>            : public:
<span class="lineNum">     143 </span>            :     TDViaFormatter(StringRef string, Boolean quoteOnTopString, Int32 fieldWidth = 0, SubString* format = null);
<span class="lineNum">     144 </span>            :     // Type formatters
<span class="lineNum">     145 </span>            :     void    FormatType(TypeRef type);
<span class="lineNum">     146 </span>            :     // Data formatters
<span class="lineNum">     147 </span>            :     void    FormatData(TypeRef type, void* pData);
<span class="lineNum">     148 </span>            :     void    FormatArrayData(TypeRef arrayType, TypedArrayCoreRef pData, Int32 rank);
<span class="lineNum">     149 </span>            :     void    FormatArrayDataRecurse(TypeRef elementType, Int32 rank, AQBlock1* pBegin,
<span class="lineNum">     150 </span>            :                 IntIndex *pDimLengths, IntIndex *pSlabLengths);
<span class="lineNum">     151 </span>            : 
<span class="lineNum">     152 </span>            :     void    FormatClusterData(TypeRef clusterType, void* pData);
<span class="lineNum">     153 </span>            :     void    FormatPointerData(TypeRef pointerType, void* pData);
<span class="lineNum">     154 </span>            :     void    FormatEncoding(EncodingEnum value);
<span class="lineNum">     155 </span>            :     void    FormatElementUsageType(UsageTypeEnum value);
<span class="lineNum">     156 </span>            :     void    FormatInt(EncodingEnum encoding, IntMax value);
<span class="lineNum">     157 </span>            :     void    FormatIEEE754(TypeRef type, void* pData);
<span class="lineNum">     158 </span>            :     
<span class="lineNum">     159 </span>            :     static char LocaleDefaultDecimalSeperator;
<span class="lineNum">     160 </span>            :     static ViaFormatChars formatVIA;
<span class="lineNum">     161 </span>            :     static ViaFormatChars formatJSON;
<span class="lineNum">     162 </span>            :     static ViaFormatChars formatC;
<span class="lineNum">     163 </span>            : };
<span class="lineNum">     164 </span>            : 
<span class="lineNum">     165 </span>            : void Format(SubString *format, Int32 count, StaticTypeAndData arguments[], StringRef buffer);
<span class="lineNum">     166 </span>            : #endif
<span class="lineNum">     167 </span>            : 
<span class="lineNum">     168 </span>            : #define tsBoolean         &quot;Boolean&quot;
<span class="lineNum">     169 </span>            : #define tsGeneric         &quot;Generic&quot;     //!&lt; Generic template place holder
<span class="lineNum">     170 </span>            : #define tsEnum            &quot;Enum&quot;        //!&lt; no numeric significance
<span class="lineNum">     171 </span>            : #define tsUInt            &quot;UInt&quot;        //!&lt; unsigned integer 0 == 00000b, max = 1111b
<span class="lineNum">     172 </span>            : #define tsSInt            &quot;S2cInt&quot;      //!&lt; signed integer two's compliment.  for 4 bits min=1000b(-8), 0 = 0000b, max = 0111b
<span class="lineNum">     173 </span>            : #define tsInt1sCompliment &quot;S1cInt&quot;      //!&lt; signed integer ones's compliment. for 4 bits min=1000b(-7), 0 = 0000b or 1111b, max = 0111b
<span class="lineNum">     174 </span>            : #define tsFixedPoint      &quot;Q&quot;           //!&lt; .xxxx fractional part of fixed point numbers   TODO fractional bits??? Q.n
<span class="lineNum">     175 </span>            : #define ts1plusFractional &quot;Q1&quot;          //!&lt; 1.xxxx  used in floating-point formats
<span class="lineNum">     176 </span>            : #define tsUnusedBits      &quot;XBits&quot;
<span class="lineNum">     177 </span>            : #define tsAscii           &quot;Ascii&quot;       //!&lt; always single byte  ISO-8859-1
<span class="lineNum">     178 </span>            : #define tsUnicode         &quot;Unicode&quot;     //!&lt; Utf8, Utf16, Utf32    (Basic Multilingual Plane 0 only right now TODO support more?)
<span class="lineNum">     179 </span>            : #define tsBiasedInt       &quot;BiasedInt&quot;   //!&lt; example, for 4 bits : -max=0000,  0 = 1xxx, max = 1111
<span class="lineNum">     180 </span>            : #define tsZigZagInt       &quot;ZigZagInt&quot;   //!&lt; used in Google's protocol buffers.
<span class="lineNum">     181 </span>            : #define tsIEEE754Binary   &quot;IEEE754B&quot;    //!&lt; Formats defined for 16,32,64 and 128 bit floating-point numbers
<span class="lineNum">     182 </span>            : 
<span class="lineNum">     183 </span>            : #define tsPointer         &quot;Pointer&quot;     // CodePointer - necessary distinction for Harvard architecture machines
<span class="lineNum">     184 </span>            : #define tsHostPointerSize &quot;HostPointerSize&quot;  // Used in BitBlock definitions
<span class="lineNum">     185 </span>            : 
<span class="lineNum">     186 </span>            : #define tsArrayTypeToken        &quot;a&quot;
<span class="lineNum">     187 </span>            : #define tsBitClusterTypeToken   &quot;bc&quot;
<span class="lineNum">     188 </span>            : #define tsBitBlockTypeToken     &quot;bb&quot;
<span class="lineNum">     189 </span>            : #define tsClusterTypeToken      &quot;c&quot;
<span class="lineNum">     190 </span>            : #define tsRequireTypeToken      &quot;require&quot;
<span class="lineNum">     191 </span>            : #define tsContextTypeToken      &quot;context&quot;
<span class="lineNum">     192 </span>            : #define tsDefineTypeToken       &quot;define&quot;
<span class="lineNum">     193 </span>            : #define tsEnqueueTypeToken      &quot;enqueue&quot;
<span class="lineNum">     194 </span>            : #define tsElementToken          &quot;e&quot;  // used for Cluster, BitCluster, and array aggregate types for simple elements
<span class="lineNum">     195 </span>            : #define tsAliasToken            &quot;al&quot; // alias to another element. 
<span class="lineNum">     196 </span>            : #define tsInputParamToken       &quot;i&quot;  // input parameter
<span class="lineNum">     197 </span>            : #define tsOutputParamToken      &quot;o&quot;  // output parameter
<span class="lineNum">     198 </span>            : #define tsInputOutputParamToken &quot;io&quot; // input-output parameter
<span class="lineNum">     199 </span>            : #define tsImmediateParamToken   &quot;im&quot; // Immediate mode parameter (not byref), only in paramblocks. size must be &lt;= size_t
<span class="lineNum">     200 </span>            : #define tsStaticParamToken      &quot;s&quot;  // static parameter, not explicitly passed, allocated in param block and preserved between
<span class="lineNum">     201 </span>            : #define tsTempParamToken        &quot;t&quot;  // temp parameter, not explicitly passed, allocated in param block and can be thrown away
<span class="lineNum">     202 </span>            : #define tsVolatileToken         &quot;x&quot;  // volatile parameter, not explicitly passed or allocated in the param block
<span class="lineNum">     203 </span>            : #define tsEquivalenceTypeToken  &quot;eq&quot; // for alternate views on the same set of bits.
<span class="lineNum">     204 </span>            : #define tsNamedTypeToken        &quot;.&quot;
<span class="lineNum">     205 </span>            : #define tsParamBlockTypeToken   &quot;p&quot;  // Used for defining param blocks used by native functions.
<span class="lineNum">     206 </span>            : #define tsPointerTypeToken      &quot;ptr&quot;
<span class="lineNum">     207 </span>            : #define tsDefaultValueToken     &quot;dv&quot;
<span class="lineNum">     208 </span>            : #define tsVarValueToken         &quot;var&quot;
<span class="lineNum">     209 </span>            : 
<span class="lineNum">     210 </span>            : #define tsClumpsToken           &quot;clumps&quot;
<span class="lineNum">     211 </span>            : #define tsClumpToken            &quot;clump&quot;
<span class="lineNum">     212 </span>            : 
<span class="lineNum">     213 </span>            : #define tsCallVIToken           &quot;CallVI&quot;
<span class="lineNum">     214 </span>            : #define tsCopyOpToken           &quot;Copy&quot;
<span class="lineNum">     215 </span>            : #define tsPerchOpToken          &quot;Perch&quot;
<span class="lineNum">     216 </span>            : #define tsFireCountOpToken      &quot;FireCount&quot;
<span class="lineNum">     217 </span>            : 
<span class="lineNum">     218 </span>            : #define tsExecutionContextType  &quot;ExecutionContext&quot;
<span class="lineNum">     219 </span>            : #define tsTypeManagerType       &quot;TypeManager&quot;
<span class="lineNum">     220 </span>            : #define tsVIClumpType           &quot;Clump&quot;
<span class="lineNum">     221 </span>            : 
<span class="lineNum">     222 </span>            : } // namespace Vireo
<span class="lineNum">     223 </span>            : 
<span class="lineNum">     224 </span>            : #endif //TDCodecVia_h
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
